> DEPRECATED: Graph-based router explanation; project now uses continuous FlowRouter. See Docs/migration_to_flow_router.md.
# EnergeticRouter Graph Architecture - ะะตัะฐะปัะฝะพะต ะพะฑัััะฝะตะฝะธะต

## โ ะะพะฟัะพั: ะงัะพ ัะฐะบะพะต "10ร1024 ัะทะปะพะฒ, ~90K ััะฑะตั"?

---

## ๐ ะะฐะทะพะฒะฐั ะฐััะธัะตะบัััะฐ

### ะัะฐั โ ะะฐััะธัะฐ!

**ะัะฐั** - ััะพ ะฝะฐะฑะพั ัะทะปะพะฒ (nodes) ะธ ะฝะฐะฟัะฐะฒะปะตะฝะฝัั ััะฑะตั (edges) ะผะตะถะดั ะฝะธะผะธ.

```
ะฃะทะปั (nodes):      ัะพัะบะธ/ะฝะตะนัะพะฝั ะฒ ัะตัะธ
ะัะฑัะฐ (edges):     ัะฒัะทะธ ะผะตะถะดั ัะทะปะฐะผะธ (ั ะฒะตัะฐะผะธ)
```

**ะะ** ะดะฒัะผะตัะฝะฐั ะผะฐััะธัะฐ, ะฐ **ะผะฝะพะณะพัะปะพะนะฝะฐั ัะตัั** ั ัะฐะทัะตะถะตะฝะฝัะผะธ ัะฒัะทัะผะธ.

---

## ๐๏ธ ะกัััะบัััะฐ baseline ะบะพะฝัะธะณะฐ (ะธะท baseline.yaml)

```yaml
router:
  layers: 10              # ะะพะปะธัะตััะฒะพ ัะปะพัะฒ
  nodes_per_layer: 1024   # ะฃะทะปะพะฒ ะฒ ะบะฐะถะดะพะผ ัะปะพะต
  neighbors:
    local: 8              # ะกะฒัะทะตะน ะบ ัะปะตะดัััะตะผั ัะปะพั (j+1)
    jump: 2               # ะกะฒัะทะตะน ัะตัะตะท ัะปะพะน (j+2)
```

### ะะธะทัะฐะปะธะทะฐัะธั ัะปะพัะฒ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะกะปะพะน 0:  [1024 ัะทะปะฐ]  โโโ  8 local + 2 jump = 10 ััะฑะตั/ัะทะตะป โ
โ ะกะปะพะน 1:  [1024 ัะทะปะฐ]  โโโ  8 local + 2 jump = 10 ััะฑะตั/ัะทะตะป โ
โ ะกะปะพะน 2:  [1024 ัะทะปะฐ]  โโโ  8 local + 2 jump = 10 ััะฑะตั/ัะทะตะป โ
โ ะกะปะพะน 3:  [1024 ัะทะปะฐ]  โโโ  8 local + 2 jump = 10 ััะฑะตั/ัะทะตะป โ
โ ะกะปะพะน 4:  [1024 ัะทะปะฐ]  โโโ  8 local + 2 jump = 10 ััะฑะตั/ัะทะตะป โ
โ ะกะปะพะน 5:  [1024 ัะทะปะฐ]  โโโ  8 local + 2 jump = 10 ััะฑะตั/ัะทะตะป โ
โ ะกะปะพะน 6:  [1024 ัะทะปะฐ]  โโโ  8 local + 2 jump = 10 ััะฑะตั/ัะทะตะป โ
โ ะกะปะพะน 7:  [1024 ัะทะปะฐ]  โโโ  8 local + 2 jump = 10 ััะฑะตั/ัะทะตะป โ
โ ะกะปะพะน 8:  [1024 ัะทะปะฐ]  โโโ  8 local (ะฝะตั jump) = 8 ััะฑะตั/ัะทะตะปโ
โ ะกะปะพะน 9:  [1024 ัะทะปะฐ]  โโโ  0 ััะฑะตั (ะฒััะพะดะฝะพะน ัะปะพะน)          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะะขะะะ ะฃะะะะ: 10 ัะปะพัะฒ ร 1024 ัะทะปะฐ = 10,240 ัะทะปะพะฒ
```

---

## ๐ ะัะฑัะฐ (Edges) - ะฟะพะดัะพะฑะฝัะน ัะฐัััั

### ะขะธะฟั ััะฑะตั:

1. **Local edges (ะปะพะบะฐะปัะฝัะต)**: ัะฒัะทะธ ะบ ัะปะตะดัััะตะผั ัะปะพั
   - ะฃะทะตะป ะฒ ัะปะพะต j โ 8 ัะทะปะพะฒ ะฒ ัะปะพะต j+1

2. **Jump edges (ะฟััะถะบะพะฒัะต)**: ัะฒัะทะธ ัะตัะตะท ัะปะพะน
   - ะฃะทะตะป ะฒ ัะปะพะต j โ 2 ัะทะปะฐ ะฒ ัะปะพะต j+2

### ะัะธะผะตั ะดะปั ะพะดะฝะพะณะพ ัะทะปะฐ ะฒ ัะปะพะต 0:

```
ะฃะทะตะป 0 ะฒ ัะปะพะต 0 ะธะผะตะตั:
  โโ 8 local edges  โ ะบ ัะทะปะฐะผ ะฒ ัะปะพะต 1
  โโ 2 jump edges   โ ะบ ัะทะปะฐะผ ะฒ ัะปะพะต 2

ะัะตะณะพ: 10 ะธััะพะดััะธั ััะฑะตั
```

### ะะธะทัะฐะปะธะทะฐัะธั ัะฒัะทะตะน:

```
ะกะปะพะน 0          ะกะปะพะน 1          ะกะปะพะน 2          ะกะปะพะน 3
[ัะทะตะป 5]  โโ8โโโ [ัะทะปั]
    โโโโโโโ2โโโโโโโโโโโโโโโโโ [ัะทะปั]

ะะตะณะตะฝะดะฐ:
โโ8โโโ  = 8 local connections
โโ2โโโ  = 2 jump connections
```

---

## ๐งฎ ะะพะปะฝัะน ัะฐัััั ััะฑะตั ะดะปั baseline ะบะพะฝัะธะณะฐ

### ะกะปะพะธ 0-7 (ะผะพะณัั ะธะผะตัั ะธ local ะธ jump):

```
ะะพะปะธัะตััะฒะพ:  8 ัะปะพัะฒ
ะฃะทะปะพะฒ:       8 ร 1024 = 8,192 ัะทะปะฐ
ะัะฑะตั:       8,192 ร (8 local + 2 jump) = 8,192 ร 10 = 81,920 ััะฑะตั
```

### ะกะปะพะน 8 (ัะพะปัะบะพ local, ะฝะตั ัะปะพั 10 ะดะปั jump):

```
ะฃะทะปะพะฒ:   1,024
ะัะฑะตั:   1,024 ร 8 local = 8,192 ััะฑะตั
```

### ะกะปะพะน 9 (ะฒััะพะดะฝะพะน, ะฝะตั ะธััะพะดััะธั ััะฑะตั):

```
ะฃะทะปะพะฒ:   1,024
ะัะฑะตั:   0
```

### **ะะขะะะ:**

```
ะฃะทะปะพะฒ:   10,240
ะัะฑะตั:   81,920 + 8,192 + 0 = 90,112 ััะฑะตั (~90K)
```

---

## ๐พ ะะฐะทะผะตั ะดะฐะฝะฝัั ะฒ ะฟะฐะผััะธ (CSR ัะพัะผะฐั)

### CSR ััััะบัััะฐ:

```swift
rowPtr: [Int]      // ะะฐะทะผะตั: (10,240 + 1) = 10,241 ัะปะตะผะตะฝัะพะฒ
colIdx: [Int]      // ะะฐะทะผะตั: 90,112 ัะปะตะผะตะฝัะพะฒ (ัะตะปะตะฒัะต ัะทะปั)
weights: [Float]   // ะะฐะทะผะตั: 90,112 ัะปะตะผะตะฝัะพะฒ (ะฒะตัะฐ ััะฑะตั)
```

### ะะฐะผััั:

```
rowPtr:    10,241 ร 4 ะฑะฐะนั =     40,964 ะฑะฐะนั (~40 KB)
colIdx:    90,112 ร 4 ะฑะฐะนั =    360,448 ะฑะฐะนั (~360 KB)
weights:   90,112 ร 4 ะฑะฐะนั =    360,448 ะฑะฐะนั (~360 KB)
positions: 10,240 ร 8 ะฑะฐะนั =     81,920 ะฑะฐะนั (~82 KB)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ะะขะะะ:                          ~843 KB ะดะปั ะฒัะตะณะพ ะณัะฐัะฐ
```

**ะญัะพ ะะงะะะฌ ัััะตะบัะธะฒะฝะพ!** ะะปะพัะฝะฐั ะผะฐััะธัะฐ 10240ร10240 ะทะฐะฝัะปะฐ ะฑั:
- 10,240ยฒ ร 4 ะฑะฐะนั = 419 MB (ะฒ 500 ัะฐะท ะฑะพะปััะต!)

---

## ๐ฏ ะัะธะผะตัั ะบะพะฝะบัะตัะฝัั ััะฑะตั

### ะฃะทะตะป 0 ะฒ ัะปะพะต 0 โ ัะฒัะทะธ:

```
Local edges (8 ัััะบ):
  Node(L0:0) โ Node(L1:0)   [ะฒะตั 1.0]
  Node(L0:0) โ Node(L1:1)   [ะฒะตั 1.0]
  Node(L0:0) โ Node(L1:2)   [ะฒะตั 1.0]
  ...ะฒัะตะณะพ 8 ััะฑะตั

Jump edges (2 ัััะบะธ):
  Node(L0:0) โ Node(L2:0)   [ะฒะตั 1.0]
  Node(L0:0) โ Node(L2:15)  [ะฒะตั 1.0]
```

### ะฃะทะตะป 512 ะฒ ัะปะพะต 5 โ ัะฒัะทะธ:

```
Local edges (8 ัััะบ):
  Node(L5:512) โ Node(L6:510)
  Node(L5:512) โ Node(L6:511)
  Node(L5:512) โ Node(L6:512)  # ัะตะฝััะฐะปัะฝัะน
  Node(L5:512) โ Node(L6:513)
  Node(L5:512) โ Node(L6:514)
  ...

Jump edges (2 ัััะบะธ):
  Node(L5:512) โ Node(L7:512)
  Node(L5:512) โ Node(L7:823)  # ัะปััะฐะนะฝัะน
```

---

## ๐ ะะฐัััะฐะฑะธัะพะฒะฐะฝะธะต

### ะัะปะธ ะทะฐัะพัะธัะต ัะฒะตะปะธัะธัั ะณัะฐั:

```yaml
# ะะฐัะธะฐะฝั 1: ะะพะปััะต ัะปะพัะฒ
router:
  layers: 20              # ะัะปะพ 10
  nodes_per_layer: 1024
  # ะะตะทัะปััะฐั: 20,480 ัะทะปะพะฒ, ~184K ััะฑะตั

# ะะฐัะธะฐะฝั 2: ะะพะปััะต ัะทะปะพะฒ ะฝะฐ ัะปะพะน
router:
  layers: 10
  nodes_per_layer: 2048   # ะัะปะพ 1024
  # ะะตะทัะปััะฐั: 20,480 ัะทะปะพะฒ, ~184K ััะฑะตั

# ะะฐัะธะฐะฝั 3: ะะพะปััะต ัะฒัะทะตะน
router:
  layers: 10
  nodes_per_layer: 1024
  neighbors:
    local: 16             # ะัะปะพ 8
    jump: 4               # ะัะปะพ 2
  # ะะตะทัะปััะฐั: 10,240 ัะทะปะพะฒ, ~184K ััะฑะตั
```

---

## ๐ CSR ัะพัะผะฐั - ะบะฐะบ ัะฐะฑะพัะฐะตั

### ะัะธะผะตั ะผะฐะปะตะฝัะบะพะณะพ ะณัะฐัะฐ (5 ัะทะปะพะฒ, 4 ัะตะฑัะฐ):

```
ะฃะทะปั:
  Node 0 โ [Node 3, Node 4]    # 2 ัะตะฑัะฐ
  Node 1 โ [Node 3]             # 1 ัะตะฑัะพ
  Node 2 โ [Node 4]             # 1 ัะตะฑัะพ
  Node 3 โ []                   # 0 ััะฑะตั
  Node 4 โ []                   # 0 ััะฑะตั

CSR ะฟัะตะดััะฐะฒะปะตะฝะธะต:
  rowPtr  = [0, 2, 3, 4, 4, 4]
           โ  โ  โ  โ  โ  โโ Node 4: ััะฑัะฐ [4..4] = ะฟัััะพ
           โ  โ  โ  โ  โโโโโ Node 3: ััะฑัะฐ [4..4] = ะฟัััะพ
           โ  โ  โ  โโโโโโโโ Node 2: ััะฑัะฐ [3..4] = 1 ัะตะฑัะพ
           โ  โ  โโโโโโโโโโโ Node 1: ััะฑัะฐ [2..3] = 1 ัะตะฑัะพ
           โ  โโโโโโโโโโโโโโ Node 0: ััะฑัะฐ [0..2] = 2 ัะตะฑัะฐ
           โโโโโโโโโโโโโโโโโ ะะฐัะฐะปะพ

  colIdx  = [3, 4, 3, 4]
           โ  โ  โ  โโ ะะตะฑัะพ 3: Node 2 โ Node 4
           โ  โ  โโโโโ ะะตะฑัะพ 2: Node 1 โ Node 3
           โ  โโโโโโโโ ะะตะฑัะพ 1: Node 0 โ Node 4
           โโโโโโโโโโโ ะะตะฑัะพ 0: Node 0 โ Node 3

  weights = [1.0, 1.0, 1.0, 1.0]
```

### ะะพัััะฟ ะบ ััะฑัะฐะผ ัะทะปะฐ 0:

```swift
let range = rowPtr[0]..<rowPtr[1]  // 0..<2
let neighbors = colIdx[range]      // [3, 4]
let edgeWeights = weights[range]   // [1.0, 1.0]
```

**O(1) ัะปะพะถะฝะพััั!** ะัะตะฝั ะฑััััะพ!

---

## โ ะัะพะณะพะฒัะน ะพัะฒะตั

### ะงัะพ ะทะฝะฐัะธั "10ร1024 ัะทะปะพะฒ, ~90K ััะฑะตั":

1. **10 ัะปะพัะฒ** ร **1024 ัะทะปะฐ ะฒ ะบะฐะถะดะพะผ** = **10,240 ัะทะปะพะฒ ะฒัะตะณะพ**
2. ะะฐะถะดัะน ัะทะตะป ะธะผะตะตั **~9 ะธััะพะดััะธั ััะฑะตั** ะฒ ััะตะดะฝะตะผ
3. **ะัะตะณะพ ~90,000 ััะฑะตั** (ะฝะฐะฟัะฐะฒะปะตะฝะฝัั ัะฒัะทะตะน ะผะตะถะดั ัะทะปะฐะผะธ)
4. **ะะต ะผะฐััะธัะฐ!** ะญัะพ ัะฐะทัะตะถะตะฝะฝัะน ะณัะฐั ะฒ CSR ัะพัะผะฐัะต
5. **ะะฐะฝะธะผะฐะตั ~850 KB** ะฒ ะฟะฐะผััะธ (ะพัะตะฝั ัััะตะบัะธะฒะฝะพ!)

### ะะพะถะฝะพ ะปะธ ัะฐััะธัะธัั ะดะพ 80000ร1024?

- **ะะตั, ััะพ ะฝะต ะฟัะพ ัะฐััะธัะตะฝะธะต!** Baseline ะบะพะฝัะธะณ: 10ร1024
- ะัะปะธ ะฝัะถะตะฝ ะฑะพะปััะธะน ะณัะฐั, ะธะทะผะตะฝะธัะต ะบะพะฝัะธะณ ะฒ `baseline.yaml`
- ะะฐะฟัะธะผะตั: `layers: 100, nodes_per_layer: 1024` = 102,400 ัะทะปะพะฒ

---

**ะะฐะดะตััั, ัะตะฟะตัั ะฐััะธัะตะบัััะฐ ะฟะพะฝััะฝะฐ! ๐ฏ**
