# EnergeticRouter Core v1 - ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ğ°Ñ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°

## ĞĞ±Ñ‰Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EnergeticCore                              â”‚
â”‚                   (Phase 2 Implementation)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚                     â”‚
        â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Â§ 2.1 Graph â”‚      â”‚ Â§ 2.2 Forwardâ”‚      â”‚ Â§ 2.3 Backpropâ”‚
â”‚  Structures  â”‚â”€â”€â”€â”€â”€â”€â”‚     Pass     â”‚â”€â”€â”€â”€â”€â”€â”‚   & Loss     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                     â”‚                     â”‚
        â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â–¼                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â–¼
â”‚ Â§ 2.4 Loggingâ”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  & Metrics   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   Optimizer      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚   (Adam)         â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§ 2.1 Graph Structures - ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GraphTypes.swift                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  struct NodeID { layer, index }                                 â”‚
â”‚  struct Edge { src, dst, weight }                               â”‚
â”‚  struct LayerConfig { nodeCount, localNeighbors, jumpNeighbors }â”‚
â”‚  struct GraphConfig { layers, nodesPerLayer, ... }              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Graph.swift                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  struct Graph {                                                 â”‚
â”‚    rowPtr: [Int]           // CSR row pointers [N+1]            â”‚
â”‚    colIdx: [Int]           // Column indices [E]                â”‚
â”‚    weights: [Float]        // Edge weights [E]                  â”‚
â”‚    nodePositions: [SIMD2]  // (x,y) positions                   â”‚
â”‚    config: GraphConfig                                          â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       GraphBuilder.swift                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  static func buildLattice(config: GraphConfig) -> Graph         â”‚
â”‚    â”œâ”€ generateLocalEdges()    // 8 neighbors in layer j+1      â”‚
â”‚    â”œâ”€ generateJumpEdges()     // 2 neighbors in layer j+2      â”‚
â”‚    â””â”€ initPositions()         // Sin/cos embeddings            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ CSR-ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹**:
```
Node 0: edges [0, 1, 2]     â†’ rowPtr[0] = 0
Node 1: edges [3, 4]        â†’ rowPtr[1] = 3
Node 2: edges [5, 6, 7, 8]  â†’ rowPtr[2] = 5
                            â†’ rowPtr[3] = 9 (end marker)

colIdx = [dstâ‚€, dstâ‚, dstâ‚‚, dstâ‚ƒ, dstâ‚„, dstâ‚…, dstâ‚†, dstâ‚‡, dstâ‚ˆ]
weights = [wâ‚€, wâ‚, wâ‚‚, wâ‚ƒ, wâ‚„, wâ‚…, wâ‚†, wâ‚‡, wâ‚ˆ]
```

---

## Â§ 2.2 Forward Pass - ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ForwardInput                               â”‚
â”‚  nodeEnergies: [Float]  // Energy per node                      â”‚
â”‚  nodeActive: [Bool]     // Active nodes mask                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RouterParams.swift                           â”‚
â”‚  Q: [Float]       // Query projections [N, d]                   â”‚
â”‚  K: [Float]       // Key projections [N, d]                     â”‚
â”‚  bias: [Float]    // Edge biases [E]                            â”‚
â”‚  tau: Float       // Softmax temperature                        â”‚
â”‚  alpha: Float     // Energy distribution coefficient            â”‚
â”‚  topK: Int        // Number of active edges                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ForwardPassCPU.forward()                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 1: Compute logits                                         â”‚
â”‚    for j in activeNodes:                                        â”‚
â”‚      for k in neighbors(j):                                     â”‚
â”‚        logit[j,k] = dot(Q[j], K[k]) + bias[edge_jk]            â”‚
â”‚        â†‘ using vDSP_dotpr from Accelerate                      â”‚
â”‚                                                                 â”‚
â”‚  Step 2: Softmax with temperature                               â”‚
â”‚    for j in activeNodes:                                        â”‚
â”‚      Ï€[j,*] = softmax(logit[j,*] / tau)                        â”‚
â”‚      â†‘ log-sum-exp trick for numerical stability               â”‚
â”‚                                                                 â”‚
â”‚  Step 3: Top-K selection (optional)                             â”‚
â”‚    for j in activeNodes:                                        â”‚
â”‚      keep only top K edges by Ï€[j,k]                           â”‚
â”‚      renormalize Ï€[j,*]                                        â”‚
â”‚                                                                 â”‚
â”‚  Step 4: Energy distribution                                    â”‚
â”‚    for edge (j â†’ k):                                           â”‚
â”‚      flow[edge] = Î± Â· energy[j] Â· Ï€[j,k]                       â”‚
â”‚      â†‘ using vDSP_vsmul for vectorization                      â”‚
â”‚                                                                 â”‚
â”‚  Step 5: Accumulate to target nodes                             â”‚
â”‚    for edge (j â†’ k):                                           â”‚
â”‚      nextEnergies[k] += flow[edge]                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ForwardOutput                               â”‚
â”‚  nextEnergies: [Float]  // Energies for next layer              â”‚
â”‚  edgePi: [Float]        // Softmax probabilities Ï€_jk           â”‚
â”‚  edgeFlow: [Float]      // Energy flows Î±Â·eÂ·Ï€_jk                â”‚
â”‚  metrics: ForwardMetrics                                        â”‚
â”‚    â”œâ”€ totalEnergy: Float                                        â”‚
â”‚    â”œâ”€ activeNodes: Int                                          â”‚
â”‚    â”œâ”€ maxEdgeFlow: Float                                        â”‚
â”‚    â””â”€ avgEntropy: Float                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§ 2.3 Backward Pass & Loss - Ğ“Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Loss Functions                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MSELoss:                                                       â”‚
â”‚    loss = mean((predicted - target)Â²)                          â”‚
â”‚    grad = 2 Â· (predicted - target) / N                         â”‚
â”‚                                                                 â”‚
â”‚  CrossEntropyLoss:                                              â”‚
â”‚    loss = -sum(target Â· log(predicted))                        â”‚
â”‚    grad = -target / predicted                                  â”‚
â”‚                                                                 â”‚
â”‚  EntropyRegularization:                                         â”‚
â”‚    loss = -Î» Â· sum(Ï€ Â· log(Ï€))                                 â”‚
â”‚    grad = -Î» Â· (log(Ï€) + 1)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BackwardPassCPU.backward()                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Input: outputGrad (from loss), forwardOutput (cached)          â”‚
â”‚                                                                 â”‚
â”‚  Step 1: Gradient through energy accumulation                   â”‚
â”‚    for edge (j â†’ k):                                           â”‚
â”‚      âˆ‚L/âˆ‚flow[edge] = outputGrad[k]                            â”‚
â”‚      âˆ‚L/âˆ‚energy[j] += Ï€[j,k] Â· Î± Â· âˆ‚L/âˆ‚flow[edge]             â”‚
â”‚      âˆ‚L/âˆ‚Ï€[j,k] = energy[j] Â· Î± Â· âˆ‚L/âˆ‚flow[edge]              â”‚
â”‚                                                                 â”‚
â”‚  Step 2: Softmax backward                                       â”‚
â”‚    for j in activeNodes:                                        â”‚
â”‚      âˆ‚L/âˆ‚logit[j,k] = Ï€[j,k] Â· (âˆ‚L/âˆ‚Ï€[j,k] - inner_product)   â”‚
â”‚      where inner_product = sum_k(Ï€[j,k] Â· âˆ‚L/âˆ‚Ï€[j,k])          â”‚
â”‚                                                                 â”‚
â”‚  Step 3: Gradients for Q, K, bias                               â”‚
â”‚    for edge (j â†’ k):                                           â”‚
â”‚      âˆ‚L/âˆ‚Q[j] += âˆ‚L/âˆ‚logit[j,k] Â· K[k]                        â”‚
â”‚      âˆ‚L/âˆ‚K[k] += âˆ‚L/âˆ‚logit[j,k] Â· Q[j]                        â”‚
â”‚      âˆ‚L/âˆ‚bias[edge] = âˆ‚L/âˆ‚logit[j,k]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BackwardOutput                             â”‚
â”‚  gradQ: [Float]       // âˆ‚L/âˆ‚Q [N, d]                          â”‚
â”‚  gradK: [Float]       // âˆ‚L/âˆ‚K [N, d]                          â”‚
â”‚  gradBias: [Float]    // âˆ‚L/âˆ‚bias [E]                          â”‚
â”‚  gradNorm: Float      // ||grad||â‚‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AdamOptimizer.step()                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  m[t] = Î²â‚ Â· m[t-1] + (1-Î²â‚) Â· grad                            â”‚
â”‚  v[t] = Î²â‚‚ Â· v[t-1] + (1-Î²â‚‚) Â· gradÂ²                           â”‚
â”‚  mÌ‚ = m[t] / (1 - Î²â‚áµ—)                                          â”‚
â”‚  vÌ‚ = v[t] / (1 - Î²â‚‚áµ—)                                          â”‚
â”‚  Î¸[t] = Î¸[t-1] - lr Â· mÌ‚ / (âˆšvÌ‚ + Îµ)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Â§ 2.4 Logging & Metrics - ĞŸĞ¾Ñ‚Ğ¾Ğº ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RouterLogger.logForward()                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  process_id: "router.forward"                                   â”‚
â”‚  data: {                                                        â”‚
â”‚    step: Int,                                                   â”‚
â”‚    total_energy: Float,                                         â”‚
â”‚    active_nodes: Int,                                           â”‚
â”‚    active_edges: Int,                                           â”‚
â”‚    avg_entropy: Float,                                          â”‚
â”‚    max_edge_flow: Float                                         â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         LoggingHub                              â”‚
â”‚  (from SharedInfrastructure)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Routes to stdout (formatted)                                 â”‚
â”‚  â€¢ Routes to file (Logs/baseline.log)                           â”‚
â”‚  â€¢ Applies level filtering (debug/info/trace)                   â”‚
â”‚  â€¢ Emits os_signpost for Instruments                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MetricsCollector                           â”‚
â”‚  (actor for thread-safety)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  private var metrics: [RouterMetrics] = []                      â”‚
â”‚                                                                 â”‚
â”‚  func record(_ metric: RouterMetrics)                           â”‚
â”‚  func latest() -> RouterMetrics?                                â”‚
â”‚  func export(to path: String)                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MetricsExporter                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  exportCSV() â†’ Artifacts/metrics.csv                            â”‚
â”‚  exportJSON() â†’ Artifacts/metrics.json                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PipelineSnapshot (updated)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Existing fields:                                               â”‚
â”‚    â€¢ timestamp, capsuleBase, capsuleBlockSize, ...              â”‚
â”‚                                                                 â”‚
â”‚  New fields (Phase 2):                                          â”‚
â”‚    â€¢ routerTotalEnergy: Float?                                  â”‚
â”‚    â€¢ routerActiveNodes: Int?                                    â”‚
â”‚    â€¢ routerActiveEdges: Int?                                    â”‚
â”‚    â€¢ routerMaxEdgeFlow: Float?                                  â”‚
â”‚    â€¢ routerLoss: Float?                                         â”‚
â”‚    â€¢ routerLayers: Int?                                         â”‚
â”‚    â€¢ routerNodesPerLayer: Int?                                  â”‚
â”‚    â€¢ routerNumEdges: Int?                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ ConfigCenter

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Configs/baseline.yaml                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ConfigCenter.load()                       â”‚
â”‚  (from SharedInfrastructure)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚             â”‚             â”‚
                â–¼             â–¼             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GraphConfigâ”‚ â”‚RouterParams â”‚ â”‚OptimizerCfg â”‚
        â”‚  â€¢ layers   â”‚ â”‚  â€¢ tau      â”‚ â”‚  â€¢ lr       â”‚
        â”‚  â€¢ nodes    â”‚ â”‚  â€¢ alpha    â”‚ â”‚  â€¢ betas    â”‚
        â”‚  â€¢ neighborsâ”‚ â”‚  â€¢ topK     â”‚ â”‚  â€¢ eps      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ (Training Loop)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Training Loop                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  for step in 0..<maxSteps:                                      â”‚
â”‚    1. Load batch â†’ ForwardInput                                 â”‚
â”‚    2. forward = forwardPass.forward(input)                      â”‚
â”‚    3. Log forward metrics                                       â”‚
â”‚    4. Compute loss on forward.nextEnergies                      â”‚
â”‚    5. backward = backwardPass.backward(loss_grad, forward)      â”‚
â”‚    6. optimizer.step(params, backward.grads)                    â”‚
â”‚    7. Log backward metrics                                      â”‚
â”‚    8. Record metrics to MetricsCollector                        â”‚
â”‚    9. Update PipelineSnapshot (every N steps)                   â”‚
â”‚   10. Save checkpoint (every M steps)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ§Ğ¸ÑĞ»ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ (Tests)

### Gradient Check (Finite Differences):
```
For each parameter Î¸áµ¢:
  Îµ = 1e-5
  Î¸[i] += Îµ
  loss_plus = forward_and_loss(Î¸)
  Î¸[i] -= 2Îµ
  loss_minus = forward_and_loss(Î¸)
  numerical_grad = (loss_plus - loss_minus) / (2Îµ)

  analytical_grad = backward(...)

  assert |numerical_grad - analytical_grad| < tolerance
```

### Energy Conservation:
```
output = forward(input)
total_in = sum(input.nodeEnergies)
total_out = sum(output.nextEnergies)

assert |total_out - alpha * total_in| < 1e-4
```

### Softmax Normalization:
```
for j in nodes:
  sum_pi = sum(edgePi[rowPtr[j]:rowPtr[j+1]])
  assert |sum_pi - 1.0| < 1e-6
```

---

## Ğ¤Ğ°Ğ¹Ğ»Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° (EnergeticCore)

```
Sources/EnergeticCore/
â”œâ”€â”€ GraphTypes.swift           # Â§ 2.1
â”œâ”€â”€ Graph.swift                # Â§ 2.1
â”œâ”€â”€ GraphBuilder.swift         # Â§ 2.1
â”œâ”€â”€ RouterParams.swift         # Â§ 2.2
â”œâ”€â”€ ForwardPassCPU.swift       # Â§ 2.2
â”œâ”€â”€ BackwardPassCPU.swift      # Â§ 2.3
â”œâ”€â”€ Loss.swift                 # Â§ 2.3
â”œâ”€â”€ Optimizer.swift            # Â§ 2.3
â”œâ”€â”€ Metrics.swift              # Â§ 2.4
â”œâ”€â”€ RouterLogger.swift         # Â§ 2.4
â””â”€â”€ MetricsExporter.swift      # Â§ 2.4

Tests/EnergeticCoreTests/
â”œâ”€â”€ GraphTypesTests.swift
â”œâ”€â”€ GraphTests.swift
â”œâ”€â”€ GraphBuilderTests.swift
â”œâ”€â”€ RouterParamsTests.swift
â”œâ”€â”€ ForwardPassCPUTests.swift
â”œâ”€â”€ BackwardPassCPUTests.swift
â”œâ”€â”€ LossTests.swift
â”œâ”€â”€ OptimizerTests.swift
â”œâ”€â”€ MetricsTests.swift
â”œâ”€â”€ RouterLoggerTests.swift
â””â”€â”€ MetricsExporterTests.swift
```

---

## ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

### Ğ’Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğµ (SPM):
- **SharedInfrastructure**: ConfigCenter, LoggingHub, ProcessRegistry
- **CapsuleCore**: EnergyMapper (Ğ´Ğ»Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ² Ñ„Ğ°Ğ·Ğµ 3)

### Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ñ„Ñ€ĞµĞ¹Ğ¼Ğ²Ğ¾Ñ€ĞºĞ¸:
- **Accelerate**: vDSP Ğ´Ğ»Ñ dot products, BLAS Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
- **Foundation**: Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹, Date, JSON

### Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğµ:
- **Yams**: Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³ YAML ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ¾Ğ² (Ñ‡ĞµÑ€ĞµĞ· SharedInfrastructure)

---

## ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ (Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ğ°Ñ Ğ½Ğ° M4)

| ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ              | Ğ Ğ°Ğ·Ğ¼ĞµÑ€       | Ğ’Ñ€ĞµĞ¼Ñ (CPU)  |
|-----------------------|--------------|--------------|
| Graph build           | 10Ã—1024      | ~10 ms       |
| Forward pass          | 10Ã—1024      | ~5-10 ms     |
| Backward pass         | 10Ã—1024      | ~8-15 ms     |
| Optimizer step        | ~50K params  | ~1-2 ms      |
| **Total iteration**   | -            | **~15-30 ms**|

_ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ: Ğ¡ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ Accelerate/vDSP, Ğ±ĞµĞ· GPU_

---

**Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾ Ğº Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸! ğŸš€**
