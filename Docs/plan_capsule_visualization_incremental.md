# –ü–ª–∞–Ω –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ CapsuleCore (macOS ¬∑ Swift ¬∑ SwiftUI)

_–° –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –¥–æ–ª–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ ‚âà 90 %: —ç—Ç–æ—Ç –ø–ª–∞–Ω –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–æ–∫—Ä—ã–≤–∞—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, —á–µ—Ä–µ–¥—É—è –±—ç–∫–µ–Ω–¥ –∏ UI-—Ñ–∞–∑—ã._

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π **CapsuleCore** (—à–∞–≥–∏ 1.1‚Äì1.5): —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –∫–æ–¥–µ–∫, Feistel PRP, CRC32, –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã bytes‚Üîdigits‚Üîprintable, EnergyMapper, CapsuleBridge, —Ç–µ—Å—Ç—ã, CLI.

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –ø–∞–π–ø–ª–∞–π–Ω–∞, –∫–æ—Ç–æ—Ä–∞—è:
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–∫–∞–∂–¥—ã–π —ç—Ç–∞–ø** —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ü–æ–∑–≤–æ–ª—è–µ—Ç **–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ** –≤–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç –∏ –Ω–∞–±–ª—é–¥–∞—Ç—å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É
- –ü–æ–º–æ–≥–∞–µ—Ç **–∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç—å** —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –°–ª—É–∂–∏—Ç **–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –æ—Ç–ª–∞–¥–∫–∏** –¥–ª—è –±—É–¥—É—â–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π
- –ì–æ—Ç–æ–≤–∞ –∫ **—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é** –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ä–æ—É—Ç–µ—Ä–∞ –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π

```
Sources/
‚îú‚îÄ CapsuleUI/
‚îÇ  ‚îú‚îÄ CapsuleUI.swift                     # —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–±–∞–∑–æ–≤—ã–π preview)
‚îÇ  ‚îú‚îÄ Models/
‚îÇ  ‚îÇ  ‚îú‚îÄ PipelineStage.swift              # –º–æ–¥–µ–ª—å —ç—Ç–∞–ø–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞
‚îÇ  ‚îÇ  ‚îú‚îÄ PipelineSnapshot.swift           # —Å–Ω–∏–º–æ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤
‚îÇ  ‚îÇ  ‚îî‚îÄ PipelineMetrics.swift            # –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
‚îÇ  ‚îú‚îÄ Executors/
‚îÇ  ‚îÇ  ‚îú‚îÄ PipelineExecutor.swift           # –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞
‚îÇ  ‚îÇ  ‚îî‚îÄ StageDataCapture.swift           # –∑–∞—Ö–≤–∞—Ç –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
‚îÇ  ‚îú‚îÄ Views/
‚îÇ  ‚îÇ  ‚îú‚îÄ CapsulePipelineView.swift        # –≥–ª–∞–≤–Ω–∞—è view –ø–∞–π–ø–ª–∞–π–Ω–∞
‚îÇ  ‚îÇ  ‚îú‚îÄ InputStageView.swift             # —ç—Ç–∞–ø: –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
‚îÇ  ‚îÇ  ‚îú‚îÄ BlockStructureView.swift         # —ç—Ç–∞–ø: Header+Data+Padding
‚îÇ  ‚îÇ  ‚îú‚îÄ PRPStageView.swift               # —ç—Ç–∞–ø: PRP —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
‚îÇ  ‚îÇ  ‚îú‚îÄ CapsuleHexView.swift             # —ç—Ç–∞–ø: –∫–∞–ø—Å—é–ª—å (hex dump)
‚îÇ  ‚îÇ  ‚îú‚îÄ DigitsStageView.swift            # —ç—Ç–∞–ø: base-B digits
‚îÇ  ‚îÇ  ‚îú‚îÄ PrintableStageView.swift         # —ç—Ç–∞–ø: printable string
‚îÇ  ‚îÇ  ‚îú‚îÄ EnergiesStageView.swift          # —ç—Ç–∞–ø: —ç–Ω–µ—Ä–≥–∏–∏ [1..B]
‚îÇ  ‚îÇ  ‚îú‚îÄ NormalizedStageView.swift        # —ç—Ç–∞–ø: –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ [0..1]
‚îÇ  ‚îÇ  ‚îú‚îÄ ReverseStageView.swift           # —ç—Ç–∞–ø: –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
‚îÇ  ‚îÇ  ‚îî‚îÄ MetricsPanelView.swift           # –ø–∞–Ω–µ–ª—å –º–µ—Ç—Ä–∏–∫
‚îÇ  ‚îú‚îÄ Components/
‚îÇ  ‚îÇ  ‚îú‚îÄ HexDumpView.swift                # –∫–æ–º–ø–æ–Ω–µ–Ω—Ç hex-–¥–∞–º–ø–∞
‚îÇ  ‚îÇ  ‚îú‚îÄ DigitsTableView.swift            # –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ã —Ü–∏—Ñ—Ä
‚îÇ  ‚îÇ  ‚îú‚îÄ StageHeaderView.swift            # –∑–∞–≥–æ–ª–æ–≤–æ–∫ —ç—Ç–∞–ø–∞
‚îÇ  ‚îÇ  ‚îú‚îÄ StageNavigationView.swift        # –Ω–∞–≤–∏–≥–∞—Ü–∏—è (prev/next/play)
‚îÇ  ‚îÇ  ‚îî‚îÄ ErrorHighlightView.swift         # –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îÇ  ‚îî‚îÄ Utilities/
‚îÇ     ‚îú‚îÄ HexFormatter.swift               # —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ hex
‚îÇ     ‚îú‚îÄ DataFormatter.swift              # —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ     ‚îî‚îÄ ColorScheme.swift                # —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ –¥–ª—è —ç—Ç–∞–ø–æ–≤
```

---

## –§–∞–∑—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ –§–ê–ó–ê 0: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ì–û–¢–û–í–û)
- CapsuleCore –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- CLI —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ë–∞–∑–æ–≤–∞—è UI —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞
- ConfigCenter, LoggingHub, ProcessRegistry –≥–æ—Ç–æ–≤—ã

---

### üéØ –§–ê–ó–ê 1: –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –ø–∞–π–ø–ª–∞–π–Ω–∞ (0.5 –¥–Ω—è)

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏.

#### 1.1. PipelineStage
```swift
public enum PipelineStageType: String, Sendable, Codable {
    case input              // –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç
    case blockStructure     // Header + Data + Padding
    case prpTransform       // PRP –ø—Ä–∏–º–µ–Ω—ë–Ω
    case capsuleBlock       // —Ñ–∏–Ω–∞–ª—å–Ω—ã–π capsule block
    case baseConversion     // –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ base-B digits
    case printableString    // printable representation
    case energiesMapping    // —ç–Ω–µ—Ä–≥–∏–∏ [1..B]
    case normalization      // –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    case reverseProcess     // –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å
    case recovered          // –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
}

public struct PipelineStage: Sendable, Identifiable {
    public let id: UUID
    public let type: PipelineStageType
    public let timestamp: Date
    public let data: StageData
    public let metrics: StageMetrics
    public let error: Error?
}

public enum StageData: Sendable {
    case text(String)
    case bytes([UInt8])
    case header(CapsuleHeader, payload: [UInt8], padding: Int)
    case digits([Int])
    case printable(String)
    case energies([Int])
    case normalized([Double])
}

public struct StageMetrics: Sendable {
    public let duration: TimeInterval
    public let inputSize: Int
    public let outputSize: Int
    public let metadata: [String: String]
}
```

#### 1.2. PipelineSnapshot
```swift
public struct PipelineSnapshot: Sendable {
    public let id: UUID
    public let generatedAt: Date
    public let inputText: String
    public let config: ConfigRoot.Capsule
    public let stages: [PipelineStage]
    public let totalDuration: TimeInterval
    public let success: Bool
}
```

_–û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: ‚âà 95 % (–ø—Ä–æ—Å—Ç—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö)._

---

### üéØ –§–ê–ó–ê 2: PipelineExecutor (1 –¥–µ–Ω—å)

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ —ç—Ç–∞–ø—ã –∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–≥–æ.

#### 2.1. PipelineExecutor
```swift
public actor PipelineExecutor {
    private let config: ConfigRoot.Capsule
    private var currentSnapshot: PipelineSnapshot?

    public init(config: ConfigRoot.Capsule)

    // –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π –ø—Ä—è–º–æ–π –ø–∞–π–ø–ª–∞–π–Ω
    public func executeForward(_ input: String) async throws -> PipelineSnapshot

    // –í—ã–ø–æ–ª–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω
    public func executeReverse(from energies: [Int]) async throws -> PipelineSnapshot

    // –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫—Ä—É–≥–æ–≤–æ–π –ø—Ä–æ—Ö–æ–¥ (forward + reverse)
    public func executeRoundtrip(_ input: String) async throws -> PipelineSnapshot
}
```

#### 2.2. –õ–æ–≥–∏–∫–∞ –∑–∞—Ö–≤–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:
1. –ó–∞—Å–µ—á—å –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é
3. –ó–∞—Å–µ—á—å –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è
4. –°–æ–∑–¥–∞—Ç—å StageData —Å –ø–æ–ª–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏
5. –í—ã—á–∏—Å–ª–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
6. –ó–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ LoggingHub
7. –î–æ–±–∞–≤–∏—Ç—å —ç—Ç–∞–ø –≤ snapshot

#### 2.3. –î–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞

**–≠—Ç–∞–ø 1: Input**
- –î–∞–Ω–Ω—ã–µ: –∏—Å—Ö–æ–¥–Ω–∞—è UTF-8 —Å—Ç—Ä–æ–∫–∞
- –ú–µ—Ç—Ä–∏–∫–∏: –¥–ª–∏–Ω–∞ –≤ –±–∞–π—Ç–∞—Ö, –¥–ª–∏–Ω–∞ –≤ —Å–∏–º–≤–æ–ª–∞—Ö

**–≠—Ç–∞–ø 2: Block Structure**
- –î–∞–Ω–Ω—ã–µ: Header (len, flags, crc32), payload bytes, padding size
- –ú–µ—Ç—Ä–∏–∫–∏: header size, payload size, padding size, total block size

**–≠—Ç–∞–ø 3: PRP Transform**
- –î–∞–Ω–Ω—ã–µ: bytes –¥–æ PRP, bytes –ø–æ—Å–ª–µ PRP
- –ú–µ—Ç—Ä–∏–∫–∏: rounds count, transform time

**–≠—Ç–∞–ø 4: Capsule Block**
- –î–∞–Ω–Ω—ã–µ: —Ñ–∏–Ω–∞–ª—å–Ω—ã–π block bytes
- –ú–µ—Ç—Ä–∏–∫–∏: block size, –ø–µ—Ä–≤—ã–µ/–ø–æ—Å–ª–µ–¥–Ω–∏–µ 16 –±–∞–π—Ç

**–≠—Ç–∞–ø 5: Base Conversion**
- –î–∞–Ω–Ω—ã–µ: –º–∞—Å—Å–∏–≤ digits [0..B-1]
- –ú–µ—Ç—Ä–∏–∫–∏: digits count, base B, —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π D

**–≠—Ç–∞–ø 6: Printable String**
- –î–∞–Ω–Ω—ã–µ: printable string (–ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É)
- –ú–µ—Ç—Ä–∏–∫–∏: string length, alphabet size

**–≠—Ç–∞–ø 7: Energies Mapping**
- –î–∞–Ω–Ω—ã–µ: –º–∞—Å—Å–∏–≤ energies [1..B]
- –ú–µ—Ç—Ä–∏–∫–∏: min/max/mean —ç–Ω–µ—Ä–≥–∏–∏, sum

**–≠—Ç–∞–ø 8: Normalization**
- –î–∞–Ω–Ω—ã–µ: normalized values [0..1]
- –ú–µ—Ç—Ä–∏–∫–∏: min/max/mean –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–≠—Ç–∞–ø 9: Reverse Process**
- –î–∞–Ω–Ω—ã–µ: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ bytes –ø–æ—Å–ª–µ inverse PRP
- –ú–µ—Ç—Ä–∏–∫–∏: –≤—Ä–µ–º—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–¥–∞

**–≠—Ç–∞–ø 10: Recovered**
- –î–∞–Ω–Ω—ã–µ: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π UTF-8 —Ç–µ–∫—Å—Ç
- –ú–µ—Ç—Ä–∏–∫–∏: CRC match (bool), recovered length

#### 2.4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LoggingHub
```swift
LoggingHub.emit(
    process: "ui.pipeline",
    level: .info,
    message: "Stage \(stage.type.rawValue) completed in \(metrics.duration)ms"
)
```

_–û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: ‚âà 90 % (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è)._

---

### üéØ –§–ê–ó–ê 3: –ë–∞–∑–æ–≤—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (0.5 –¥–Ω—è)

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

#### 3.1. HexDumpView
```swift
struct HexDumpView: View {
    let bytes: [UInt8]
    let bytesPerRow: Int = 16
    let highlightRange: Range<Int>?

    var body: some View {
        // –§–æ—Ä–º–∞—Ç: offset | hex bytes | ASCII
        // 00000000 | 48 65 6c 6c 6f 20 57 6f | Hello Wo
        // 00000008 | 72 6c 64 21 00 00 00 00 | rld!....
    }
}
```

#### 3.2. DigitsTableView
```swift
struct DigitsTableView: View {
    let digits: [Int]
    let base: Int
    let columns: Int = 10
    let highlightIndices: Set<Int>?

    var body: some View {
        // Grid —Å digits, –ø–æ–∑–∏—Ü–∏—è –∏ –∑–Ω–∞—á–µ–Ω–∏–µ
        // [0]: 42   [1]: 15   [2]: 89 ...
    }
}
```

#### 3.3. StageHeaderView
```swift
struct StageHeaderView: View {
    let stage: PipelineStage
    let expanded: Bool
    let onToggle: () -> Void

    var body: some View {
        HStack {
            Image(systemName: iconForStage(stage.type))
            Text(stage.type.rawValue)
            Spacer()
            if let error = stage.error {
                Image(systemName: "exclamationmark.triangle")
                    .foregroundColor(.red)
            }
            Text("\(stage.metrics.duration * 1000, specifier: "%.2f") ms")
                .font(.caption)
                .foregroundColor(.secondary)
            Image(systemName: expanded ? "chevron.down" : "chevron.right")
        }
    }
}
```

#### 3.4. StageNavigationView
```swift
struct StageNavigationView: View {
    let currentIndex: Int
    let totalStages: Int
    let isPlaying: Bool
    let onPrevious: () -> Void
    let onNext: () -> Void
    let onTogglePlay: () -> Void
    let onReset: () -> Void

    var body: some View {
        HStack {
            Button(action: onPrevious) {
                Image(systemName: "chevron.left.circle")
            }
            .disabled(currentIndex == 0)

            Button(action: onTogglePlay) {
                Image(systemName: isPlaying ? "pause.circle" : "play.circle")
            }

            Button(action: onNext) {
                Image(systemName: "chevron.right.circle")
            }
            .disabled(currentIndex >= totalStages - 1)

            Spacer()

            Text("\(currentIndex + 1) / \(totalStages)")
                .font(.caption)

            Spacer()

            Button(action: onReset) {
                Image(systemName: "arrow.counterclockwise.circle")
            }
        }
    }
}
```

_–û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: ‚âà 95 % (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ SwiftUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)._

---

### üéØ –§–ê–ó–ê 4: –î–µ—Ç–∞–ª—å–Ω—ã–µ view –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ (1.5 –¥–Ω—è)

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ view –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —ç—Ç–∞–ø–∞.

#### 4.1. InputStageView
```swift
struct InputStageView: View {
    let stage: PipelineStage

    var body: some View {
        if case let .text(input) = stage.data {
            VStack(alignment: .leading, spacing: 8) {
                Text("Original Text")
                    .font(.headline)

                Text(input)
                    .font(.body)
                    .padding()
                    .background(Color.gray.opacity(0.1))
                    .cornerRadius(8)

                LabeledContent("Length (bytes)", value: "\(stage.metrics.inputSize)")
                LabeledContent("Length (chars)", value: "\(input.count)")
            }
        }
    }
}
```

#### 4.2. BlockStructureView
```swift
struct BlockStructureView: View {
    let stage: PipelineStage

    var body: some View {
        if case let .header(header, payload, paddingSize) = stage.data {
            VStack(alignment: .leading, spacing: 12) {
                // Header details
                GroupBox("Header (\(CapsuleHeader.byteCount) bytes)") {
                    LabeledContent("Length", value: "\(header.length)")
                    LabeledContent("Flags", value: "0x\(String(header.flags, radix: 16))")
                    LabeledContent("CRC32", value: "0x\(String(header.crc32, radix: 16))")
                }

                // Payload
                GroupBox("Payload (\(payload.count) bytes)") {
                    HexDumpView(bytes: payload, highlightRange: nil)
                }

                // Padding
                LabeledContent("Padding", value: "\(paddingSize) bytes")

                // Total
                LabeledContent("Total Block Size", value: "\(stage.metrics.outputSize) bytes")
            }
        }
    }
}
```

#### 4.3. PRPStageView
```swift
struct PRPStageView: View {
    let beforePRP: [UInt8]
    let afterPRP: [UInt8]
    let rounds: Int

    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            Text("Feistel PRP (\(rounds) rounds)")
                .font(.headline)

            GroupBox("Before PRP (first/last 16 bytes)") {
                HStack {
                    HexDumpView(bytes: Array(beforePRP.prefix(16)), highlightRange: nil)
                    Text("...")
                    HexDumpView(bytes: Array(beforePRP.suffix(16)), highlightRange: nil)
                }
            }

            Image(systemName: "arrow.down.circle")
                .font(.title2)

            GroupBox("After PRP (first/last 16 bytes)") {
                HStack {
                    HexDumpView(bytes: Array(afterPRP.prefix(16)), highlightRange: nil)
                    Text("...")
                    HexDumpView(bytes: Array(afterPRP.suffix(16)), highlightRange: nil)
                }
            }
        }
    }
}
```

#### 4.4. DigitsStageView
```swift
struct DigitsStageView: View {
    let stage: PipelineStage

    var body: some View {
        if case let .digits(digits) = stage.data {
            VStack(alignment: .leading, spacing: 12) {
                Text("Base-\(stage.config.base) Digits")
                    .font(.headline)

                LabeledContent("Total Digits", value: "\(digits.count)")
                LabeledContent("Range", value: "[0..\(stage.config.base - 1)]")

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 50 + –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10
                GroupBox("Digits (first 50 + last 10)") {
                    DigitsTableView(
                        digits: Array(digits.prefix(50)) + Array(digits.suffix(10)),
                        base: stage.config.base,
                        columns: 10,
                        highlightIndices: nil
                    )
                }
            }
        }
    }
}
```

#### 4.5. EnergiesStageView
```swift
struct EnergiesStageView: View {
    let stage: PipelineStage

    var body: some View {
        if case let .energies(energies) = stage.data {
            let min = energies.min() ?? 0
            let max = energies.max() ?? 0
            let mean = Double(energies.reduce(0, +)) / Double(energies.count)
            let sum = energies.reduce(0, +)

            VStack(alignment: .leading, spacing: 12) {
                Text("Energies [1..\(stage.config.base)]")
                    .font(.headline)

                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                GroupBox("Statistics") {
                    LabeledContent("Count", value: "\(energies.count)")
                    LabeledContent("Min", value: "\(min)")
                    LabeledContent("Max", value: "\(max)")
                    LabeledContent("Mean", value: String(format: "%.2f", mean))
                    LabeledContent("Sum", value: "\(sum)")
                }

                // –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ (–ø—Ä–æ—Å—Ç–∞—è)
                GroupBox("Distribution") {
                    // TODO: –ø—Ä–æ—Å—Ç–∞—è chart/–≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–π
                }

                // –ü–µ—Ä–≤—ã–µ/–ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
                GroupBox("Values (first 50 + last 10)") {
                    DigitsTableView(
                        digits: Array(energies.prefix(50)) + Array(energies.suffix(10)),
                        base: stage.config.base + 1,
                        columns: 10,
                        highlightIndices: nil
                    )
                }
            }
        }
    }
}
```

#### 4.6. NormalizedStageView
```swift
struct NormalizedStageView: View {
    let stage: PipelineStage

    var body: some View {
        if case let .normalized(values) = stage.data {
            let min = values.min() ?? 0
            let max = values.max() ?? 0
            let mean = values.reduce(0, +) / Double(values.count)

            VStack(alignment: .leading, spacing: 12) {
                Text("Normalized Values [0..1]")
                    .font(.headline)

                GroupBox("Statistics") {
                    LabeledContent("Count", value: "\(values.count)")
                    LabeledContent("Min", value: String(format: "%.6f", min))
                    LabeledContent("Max", value: String(format: "%.6f", max))
                    LabeledContent("Mean", value: String(format: "%.6f", mean))
                }

                // –ü–µ—Ä–≤—ã–µ/–ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
                GroupBox("Values (first 30 + last 10)") {
                    ScrollView {
                        LazyVGrid(columns: Array(repeating: GridItem(.flexible()), count: 5)) {
                            ForEach(Array((Array(values.prefix(30)) + Array(values.suffix(10))).enumerated()), id: \.offset) { idx, val in
                                VStack {
                                    Text("[\(idx)]")
                                        .font(.caption2)
                                        .foregroundColor(.secondary)
                                    Text(String(format: "%.4f", val))
                                        .font(.caption)
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
```

#### 4.7. ReverseStageView
```swift
struct ReverseStageView: View {
    let stage: PipelineStage

    var body: some View {
        VStack(alignment: .leading, spacing: 12) {
            Text("Reverse Process")
                .font(.headline)

            Text("–≠–Ω–µ—Ä–≥–∏–∏ ‚Üí Digits ‚Üí Bytes ‚Üí PRP‚Åª¬π ‚Üí Header/Data")
                .font(.caption)
                .foregroundColor(.secondary)

            if case let .bytes(bytes) = stage.data {
                GroupBox("Recovered Bytes") {
                    HexDumpView(bytes: bytes, highlightRange: nil)
                }
            }

            LabeledContent("Duration", value: String(format: "%.2f ms", stage.metrics.duration * 1000))
        }
    }
}
```

#### 4.8. RecoveredStageView
```swift
struct RecoveredStageView: View {
    let stage: PipelineStage
    let originalText: String

    var body: some View {
        if case let .text(recovered) = stage.data {
            let crcMatch = recovered == originalText

            VStack(alignment: .leading, spacing: 12) {
                HStack {
                    Text("Recovered Text")
                        .font(.headline)
                    Spacer()
                    if crcMatch {
                        Label("CRC Match", systemImage: "checkmark.circle.fill")
                            .foregroundColor(.green)
                    } else {
                        Label("CRC Mismatch", systemImage: "xmark.circle.fill")
                            .foregroundColor(.red)
                    }
                }

                Text(recovered)
                    .font(.body)
                    .padding()
                    .background(crcMatch ? Color.green.opacity(0.1) : Color.red.opacity(0.1))
                    .cornerRadius(8)

                // Comparison
                if !crcMatch {
                    GroupBox("Comparison") {
                        LabeledContent("Original", value: originalText)
                        LabeledContent("Recovered", value: recovered)
                    }
                }
            }
        }
    }
}
```

_–û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: ‚âà 85 % (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ view, —Ç—Ä–µ–±—É—é—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏)._

---

### üéØ –§–ê–ó–ê 5: –ì–ª–∞–≤–Ω–∞—è CapsulePipelineView (1 –¥–µ–Ω—å)

**–¶–µ–ª—å:** –°–æ–±—Ä–∞—Ç—å –≤—Å—ë –≤–º–µ—Å—Ç–µ –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

#### 5.1. CapsulePipelineView
```swift
public struct CapsulePipelineView: View {
    @StateObject private var executor: PipelineExecutorViewModel
    @State private var inputText: String
    @State private var currentStageIndex: Int = 0
    @State private var isPlaying: Bool = false
    @State private var expandedStages: Set<UUID> = []

    public init(config: ConfigRoot.Capsule) {
        _executor = StateObject(wrappedValue: PipelineExecutorViewModel(config: config))
        _inputText = State(initialValue: config.pipelineExampleText)
    }

    public var body: some View {
        NavigationSplitView {
            // –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ + –º–µ—Ç—Ä–∏–∫–∏
            VStack(alignment: .leading, spacing: 16) {
                // Input
                GroupBox("Input") {
                    TextEditor(text: $inputText)
                        .frame(height: 100)
                    Button("Execute Pipeline") {
                        Task {
                            await executor.execute(inputText)
                            currentStageIndex = 0
                        }
                    }
                    .buttonStyle(.borderedProminent)
                }

                // Navigation
                if let snapshot = executor.snapshot {
                    StageNavigationView(
                        currentIndex: currentStageIndex,
                        totalStages: snapshot.stages.count,
                        isPlaying: isPlaying,
                        onPrevious: { currentStageIndex = max(0, currentStageIndex - 1) },
                        onNext: { currentStageIndex = min(snapshot.stages.count - 1, currentStageIndex + 1) },
                        onTogglePlay: {
                            isPlaying.toggle()
                            if isPlaying {
                                startAutoPlay()
                            }
                        },
                        onReset: { currentStageIndex = 0 }
                    )
                }

                // Metrics Panel
                if let snapshot = executor.snapshot {
                    MetricsPanelView(snapshot: snapshot)
                }

                Spacer()
            }
            .padding()
            .frame(width: 300)
        } detail: {
            // –ì–ª–∞–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å: —Ç–µ–∫—É—â–∏–π —ç—Ç–∞–ø
            if let snapshot = executor.snapshot {
                ScrollView {
                    VStack(alignment: .leading, spacing: 20) {
                        ForEach(Array(snapshot.stages.enumerated()), id: \.element.id) { idx, stage in
                            let isExpanded = expandedStages.contains(stage.id)
                            let isCurrent = idx == currentStageIndex

                            VStack(alignment: .leading, spacing: 8) {
                                StageHeaderView(
                                    stage: stage,
                                    expanded: isExpanded,
                                    onToggle: {
                                        if isExpanded {
                                            expandedStages.remove(stage.id)
                                        } else {
                                            expandedStages.insert(stage.id)
                                        }
                                    }
                                )
                                .onTapGesture {
                                    currentStageIndex = idx
                                }

                                if isExpanded || isCurrent {
                                    stageDetailView(for: stage, snapshot: snapshot)
                                        .padding(.leading, 20)
                                }
                            }
                            .padding()
                            .background(isCurrent ? Color.blue.opacity(0.1) : Color.clear)
                            .cornerRadius(8)
                            .overlay(
                                RoundedRectangle(cornerRadius: 8)
                                    .stroke(isCurrent ? Color.blue : Color.clear, lineWidth: 2)
                            )
                        }
                    }
                    .padding()
                }
            } else {
                VStack {
                    Image(systemName: "arrow.left")
                    Text("Enter text and execute pipeline")
                        .foregroundColor(.secondary)
                }
            }
        }
        .navigationTitle("Capsule Pipeline Visualizer")
    }

    @ViewBuilder
    private func stageDetailView(for stage: PipelineStage, snapshot: PipelineSnapshot) -> some View {
        switch stage.type {
        case .input:
            InputStageView(stage: stage)
        case .blockStructure:
            BlockStructureView(stage: stage)
        case .prpTransform:
            if let prevStage = snapshot.stages.first(where: { $0.type == .blockStructure }) {
                PRPStageView(
                    beforePRP: extractBytes(from: prevStage.data),
                    afterPRP: extractBytes(from: stage.data),
                    rounds: snapshot.config.feistelRounds
                )
            }
        case .capsuleBlock:
            if case let .bytes(bytes) = stage.data {
                CapsuleHexView(bytes: bytes)
            }
        case .baseConversion:
            DigitsStageView(stage: stage)
        case .printableString:
            PrintableStageView(stage: stage)
        case .energiesMapping:
            EnergiesStageView(stage: stage)
        case .normalization:
            NormalizedStageView(stage: stage)
        case .reverseProcess:
            ReverseStageView(stage: stage)
        case .recovered:
            RecoveredStageView(stage: stage, originalText: snapshot.inputText)
        }
    }

    private func startAutoPlay() {
        Timer.scheduledTimer(withTimeInterval: 1.5, repeats: true) { timer in
            guard isPlaying else {
                timer.invalidate()
                return
            }
            if let snapshot = executor.snapshot, currentStageIndex < snapshot.stages.count - 1 {
                currentStageIndex += 1
            } else {
                isPlaying = false
                timer.invalidate()
            }
        }
    }
}
```

#### 5.2. PipelineExecutorViewModel
```swift
@MainActor
public class PipelineExecutorViewModel: ObservableObject {
    @Published public var snapshot: PipelineSnapshot?
    @Published public var isExecuting: Bool = false
    @Published public var error: Error?

    private let executor: PipelineExecutor

    public init(config: ConfigRoot.Capsule) {
        self.executor = PipelineExecutor(config: config)
    }

    public func execute(_ input: String) async {
        isExecuting = true
        error = nil

        do {
            let result = try await executor.executeRoundtrip(input)
            snapshot = result
            LoggingHub.emit(
                process: "ui.pipeline",
                level: .info,
                message: "Pipeline executed: \(result.stages.count) stages, \(result.totalDuration * 1000)ms"
            )
        } catch {
            self.error = error
            LoggingHub.emit(
                process: "ui.pipeline",
                level: .error,
                message: "Pipeline failed: \(error.localizedDescription)"
            )
        }

        isExecuting = false
    }
}
```

_–û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: ‚âà 85 % (SwiftUI coordination, —Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)._

---

### üéØ –§–ê–ó–ê 6: MetricsPanelView –∏ —É—Ç–∏–ª–∏—Ç—ã (0.5 –¥–Ω—è)

#### 6.1. MetricsPanelView
```swift
struct MetricsPanelView: View {
    let snapshot: PipelineSnapshot

    var body: some View {
        GroupBox("Pipeline Metrics") {
            LabeledContent("Total Duration", value: String(format: "%.2f ms", snapshot.totalDuration * 1000))
            LabeledContent("Stages", value: "\(snapshot.stages.count)")
            LabeledContent("Success", value: snapshot.success ? "‚úì" : "‚úó")

            Divider()

            ForEach(snapshot.stages) { stage in
                HStack {
                    Text(stage.type.rawValue)
                        .font(.caption2)
                    Spacer()
                    Text(String(format: "%.2f ms", stage.metrics.duration * 1000))
                        .font(.caption2)
                        .foregroundColor(.secondary)
                }
            }
        }
    }
}
```

#### 6.2. HexFormatter
```swift
public enum HexFormatter {
    public static func format(bytes: [UInt8], bytesPerRow: Int = 16) -> String {
        var result = ""
        for (offset, chunk) in bytes.chunked(into: bytesPerRow).enumerated() {
            let address = String(format: "%08X", offset * bytesPerRow)
            let hexPart = chunk.map { String(format: "%02X", $0) }.joined(separator: " ")
            let asciiPart = chunk.map { byte in
                (32...126).contains(byte) ? String(Character(UnicodeScalar(byte))) : "."
            }.joined()
            result += "\(address) | \(hexPart.padding(toLength: bytesPerRow * 3, withPad: " ", startingAt: 0)) | \(asciiPart)\n"
        }
        return result
    }
}
```

#### 6.3. ColorScheme
```swift
public enum VisualizationColorScheme {
    public static func color(for stageType: PipelineStageType) -> Color {
        switch stageType {
        case .input: return .blue
        case .blockStructure: return .cyan
        case .prpTransform: return .purple
        case .capsuleBlock: return .indigo
        case .baseConversion: return .green
        case .printableString: return .mint
        case .energiesMapping: return .orange
        case .normalization: return .yellow
        case .reverseProcess: return .pink
        case .recovered: return .green
        }
    }

    public static func icon(for stageType: PipelineStageType) -> String {
        switch stageType {
        case .input: return "text.cursor"
        case .blockStructure: return "square.grid.3x3"
        case .prpTransform: return "lock.rotation"
        case .capsuleBlock: return "cube.fill"
        case .baseConversion: return "number.circle"
        case .printableString: return "text.quote"
        case .energiesMapping: return "bolt.fill"
        case .normalization: return "slider.horizontal.3"
        case .reverseProcess: return "arrow.uturn.backward"
        case .recovered: return "checkmark.circle.fill"
        }
    }
}
```

_–û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: ‚âà 95 % (–≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã)._

---

### üéØ –§–ê–ó–ê 7: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞ (0.5 –¥–Ω—è)

#### 7.1. –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å `config.pipelineExampleText`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –≤–∏–∑—É–∞–ª—å–Ω–æ
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é (prev/next/play)
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤—Ö–æ–¥–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏:
  - –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
  - –û—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∞—è (1-2 —Å–∏–º–≤–æ–ª–∞)
  - –°—Ä–µ–¥–Ω—è—è (50-100 —Å–∏–º–≤–æ–ª–æ–≤)
  - –ë–ª–∏–∑–∫–∞—è –∫ max_input_bytes (256)
  - –° —é–Ω–∏–∫–æ–¥–æ–º (–∫–∏—Ä–∏–ª–ª–∏—Ü–∞, —ç–º–æ–¥–∑–∏)

#### 7.2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
- –°—Ä–∞–≤–Ω–∏—Ç—å —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Å CLI
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–∑–º–µ—Ä–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
- –£–±–µ–¥–∏—Ç—å—Å—è –≤ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ CRC

#### 7.3. UI polish
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å —à—Ä–∏—Ñ—Ç–æ–≤
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å spacing/padding
- –î–æ–±–∞–≤–∏—Ç—å tooltips –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

_–û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: ‚âà 90 % (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ QA)._

---

## –§–ê–ó–ê 8: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 8.1. –≠–∫—Å–ø–æ—Ä—Ç —Å–Ω–∞–ø—à–æ—Ç–æ–≤
```swift
Button("Export Snapshot") {
    if let snapshot = executor.snapshot {
        let encoder = JSONEncoder()
        encoder.outputFormatting = [.prettyPrinted, .sortedKeys]
        if let data = try? encoder.encode(snapshot) {
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ Artifacts/Snapshots/
        }
    }
}
```

### 8.2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–Ω–∞–ø—à–æ—Ç–æ–≤
- –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–≤–∞ —Å–Ω–∞–ø—à–æ—Ç–∞
- –ü–æ–∫–∞–∑–∞—Ç—å diff –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ PRP/–∞–ª–≥–æ—Ä–∏—Ç–º–∞—Ö

### 8.3. –ü—Ä–æ—Å—Ç–∞—è Charts –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
```swift
import Charts

struct EnergyDistributionChart: View {
    let energies: [Int]

    var body: some View {
        let histogram = Dictionary(grouping: energies, by: { $0 })
            .mapValues { $0.count }

        Chart {
            ForEach(Array(histogram.keys.sorted()), id: \.self) { energy in
                BarMark(
                    x: .value("Energy", energy),
                    y: .value("Count", histogram[energy] ?? 0)
                )
            }
        }
        .frame(height: 200)
    }
}
```

### 8.4. –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- –î–æ–±–∞–≤–∏—Ç—å –ø–ª–∞–≤–Ω—ã–µ transitions –º–µ–∂–¥—É —ç—Ç–∞–ø–∞–º–∏
- –ê–Ω–∏–º–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ hex-–¥–∞–º–ø–∞—Ö
- Highlight –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö –±–∞–π—Ç–æ–≤ –ø—Ä–∏ PRP

_–û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: ‚âà 80 % (nice-to-have features)._

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π

### ConfigCenter
- –î–æ–±–∞–≤–∏—Ç—å –≤ `ui` —Å–µ–∫—Ü–∏—é –∫–æ–Ω—Ñ–∏–≥–∞:
```yaml
ui:
  pipeline:
    enabled: true
    auto_expand_errors: true
    hex_bytes_per_row: 16
    digits_per_row: 10
    animation_speed: 1.5  # seconds per stage
```

### LoggingHub
–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
```swift
LoggingHub.emit(process: "ui.pipeline", level: .info, message: "Stage changed to \(newStage)")
LoggingHub.emit(process: "ui.pipeline", level: .debug, message: "Snapshot loaded: \(snapshot.id)")
```

### ProcessRegistry
–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:
- `ui.pipeline` ‚Äî –≥–ª–∞–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- `ui.stage.input`, `ui.stage.block`, ... ‚Äî –¥–µ—Ç–∞–ª–∏ —ç—Ç–∞–ø–æ–≤
- `ui.executor` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞

---

## –¢–æ—á–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è –±—É–¥—É—â–∏—Ö —Ñ–∞–∑

### –ö–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏—Ç—Å—è Router (–§–∞–∑–∞ 9+):
1. **–ù–æ–≤—ã–π —ç—Ç–∞–ø:** `routerForward` –ø–æ—Å–ª–µ `normalization`
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ —ç–Ω–µ—Ä–≥–∏–∏
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≥—Ä–∞—Ñ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ (—Å–ª–æ–∏, —É–∑–ª—ã, —Ä—ë–±—Ä–∞)
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—ã—Ö–æ–¥–Ω—ã–µ —ç–Ω–µ—Ä–≥–∏–∏ –ø–æ—Å–ª–µ —Ä–æ—É—Ç–µ—Ä–∞

2. **–ù–æ–≤—ã–π —ç—Ç–∞–ø:** `routerBackward` –ø–µ—Ä–µ–¥ `reverseProcess`
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ (—ç–Ω—Ç—Ä–æ–ø–∏—è, –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—É—Ç–∏)

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** `CapsulePipelineView` + `RouterGraphView`
   - Split view: —Å–ª–µ–≤–∞ –ø–∞–π–ø–ª–∞–π–Ω –∫–∞–ø—Å—é–ª—è, —Å–ø—Ä–∞–≤–∞ –≥—Ä–∞—Ñ —Ä–æ—É—Ç–µ—Ä–∞
   - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —ç—Ç–∞–ø energiesMapping ‚Äî –ø–æ–¥—Å–≤–µ—Ç–∏—Ç—å –≤—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π —Ä–æ—É—Ç–µ—Ä–∞

### –ö–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏—Ç—Å—è –æ–±—É—á–µ–Ω–∏–µ:
1. **–ù–æ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞:** Training Progress
   - –ì—Ä–∞—Ñ–∏–∫ loss/accuracy
   - Batch-by-batch –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
   - Checkpoint management

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π:**
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å, –∫–∞–∫ –º–µ–Ω—è—é—Ç—Å—è –º–∞—Ä—à—Ä—É—Ç—ã –≤ —Ä–æ—É—Ç–µ—Ä–µ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ –æ—à–∏–±–æ–∫ SNN –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ø—Å—é–ª—è

---

## –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ (—Å—Ä–æ–∫–∏)

| –§–∞–∑–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –í—Ä–µ–º—è | –°—Ç–∞—Ç—É—Å |
|------|----------|-------|--------|
| 0 | –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ | ‚Äî | ‚úÖ –ì–û–¢–û–í–û |
| 1 | –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –ø–∞–π–ø–ª–∞–π–Ω–∞ | 0.5 –¥–Ω—è | üéØ –°–õ–ï–î–£–Æ–©–ê–Ø |
| 2 | PipelineExecutor | 1 –¥–µ–Ω—å | ‚è≥ |
| 3 | –ë–∞–∑–æ–≤—ã–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | 0.5 –¥–Ω—è | ‚è≥ |
| 4 | –î–µ—Ç–∞–ª—å–Ω—ã–µ view —ç—Ç–∞–ø–æ–≤ | 1.5 –¥–Ω—è | ‚è≥ |
| 5 | –ì–ª–∞–≤–Ω–∞—è CapsulePipelineView | 1 –¥–µ–Ω—å | ‚è≥ |
| 6 | –ú–µ—Ç—Ä–∏–∫–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã | 0.5 –¥–Ω—è | ‚è≥ |
| 7 | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞ | 0.5 –¥–Ω—è | ‚è≥ |
| 8 | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è | –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | üí° |

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** ‚âà 5.5 –¥–Ω—è –¥–ª—è –ø–æ–ª–Ω–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ CapsuleCore.

---

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|-----------|
| SwiftUI performance —Å –±–æ–ª—å—à–∏–º–∏ hex-–¥–∞–º–ø–∞–º–∏ | 60% | –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (LazyVStack), –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞ –ø–µ—Ä–≤—ã—Ö/–ø–æ—Å–ª–µ–¥–Ω–∏—Ö N –±–∞–π—Ç |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ async executor + UI | 40% | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å @MainActor, ObservableObject, —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤ |
| –ü–µ—Ä–µ—É—Å–ª–æ–∂–Ω–µ–Ω–∏–µ UI –Ω–∞ —Ä–∞–Ω–Ω–∏—Ö —ç—Ç–∞–ø–∞—Ö | 50% | –ù–∞—á–∞—Ç—å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ MVP (—Ñ–∞–∑—ã 1-5), –¥–æ–±–∞–≤–ª—è—Ç—å —É–ª—É—á—à–µ–Ω–∏—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ |
| –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –±—É–¥—É—â–∏–º —Ä–æ—É—Ç–µ—Ä–æ–º | 30% | –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—à–∏—Ä—è–µ–º—É—é –º–æ–¥–µ–ª—å (enum StageType –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è) |

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

‚úÖ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–≤—Å–µ 10 —ç—Ç–∞–ø–æ–≤** –ø–∞–π–ø–ª–∞–π–Ω–∞
‚úÖ –ú–æ–∂–Ω–æ **–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ** –≤–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç –∏ –Ω–∞–±–ª—é–¥–∞—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏
‚úÖ –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–¥–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** (hex, digits, energies)
‚úÖ **–ú–µ—Ç—Ä–∏–∫–∏** –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã –∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å CLI
‚úÖ **CRC –ø—Ä–æ–≤–µ—Ä–∫–∞** —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
‚úÖ UI **—Ä–∞—Å—à–∏—Ä—è–µ–º–∞** –¥–ª—è –±—É–¥—É—â–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Ä–æ—É—Ç–µ—Ä–æ–º
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ **LoggingHub** —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ **—Ä–µ–∞–ª—å–Ω—ã–µ** (–Ω–µ mock)

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ **—Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö** –∏–∑ CapsuleCore, –±–µ–∑ mock-–¥–∞–Ω–Ω—ã—Ö.
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç **–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ**: –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –±—ç–∫–µ–Ω–¥—É, –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ñ–∏—á–∏, –∑–∞—Ç–µ–º —Å–Ω–æ–≤–∞ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é.
- **Fail-fast** –ø–æ–ª–∏—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è: –æ—à–∏–±–∫–∏ –Ω–∞ –ª—é–±–æ–º —ç—Ç–∞–ø–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è –≤ UI, –Ω–æ –Ω–µ —Å–∫—Ä—ã–≤–∞—é—Ç—Å—è.
- –ü–ª–∞–Ω —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω —Å –æ–±—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –∏–∑ `plan_reversible_text_capsule_swift_macos.md` –∏ `plan_snn_router_swift_macos.md`.

_–° –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –¥–æ–ª–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ ‚âà 90 %: —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–º—É –ø–ª–∞–Ω—É –¥–∞—Å—Ç –Ω–∞–≥–ª—è–¥–Ω—É—é, —Ä–∞—Å—à–∏—Ä—è–µ–º—É—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Å—Ç–∞–Ω–µ—Ç –∫–ª—é—á–µ–≤—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∏ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã._
